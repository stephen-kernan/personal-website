<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><meta charset="utf-8"/><link rel="icon" href="../public/personal-logo.svg"/><meta name="theme-color" content="#000000"/><meta name="description" content="Web site created using create-react-app"/><link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Epilogue:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;family=Sora:wght@400;500;600;700;800&amp;display=swap"/><link rel="manifest" href="%PUBLIC_URL%/manifest.json"/><link rel="preload" href="/_next/static/css/d1c395a3cf3ad9ea.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d1c395a3cf3ad9ea.css" data-n-g=""/><link rel="preload" href="/_next/static/css/d0db4ab15bbeaf44.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d0db4ab15bbeaf44.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2d735a70f5f8a372.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-c29ce357e8c9f670.js" defer=""></script><script src="/_next/static/chunks/pages/_app-218372f744f0ee87.js" defer=""></script><script src="/_next/static/chunks/672-0aa3f58bb32c667c.js" defer=""></script><script src="/_next/static/chunks/775-16b9dd90ce23a30e.js" defer=""></script><script src="/_next/static/chunks/pages/blog/prop-constructor-pattern-d317f9e6ce0694de.js" defer=""></script><script src="/_next/static/4BpwgWXTCw54Ent2NKMWK/_buildManifest.js" defer=""></script><script src="/_next/static/4BpwgWXTCw54Ent2NKMWK/_ssgManifest.js" defer=""></script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Epilogue:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Sora:wght@400;500;600;700;800&display=swap"/></head><body><div id="__next"><style data-emotion="css-global 2rmien">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:#f3f2f1;font-family:'Epilogue','Sora',sans-serif;font-size:clamp(1rem, 4vw, 1.25rem);line-height:1.75em;font-weight:400;background-color:#373638;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#373638;}</style><div class="page-container"><style data-emotion="css 5qus04">.css-5qus04{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:static;}</style><style data-emotion="css wlew6x">.css-wlew6x{background-color:#373638;color:#f3f2f1;-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);background-image:linear-gradient(rgba(255, 255, 255, 0.09), rgba(255, 255, 255, 0.09));display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:static;}</style><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic page-nav global-nav css-wlew6x"><style data-emotion="css 14ohe92">.css-14ohe92{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:16px;padding-right:16px;min-height:56px;background-color:#373638;}@media (min-width:600px){.css-14ohe92{padding-left:24px;padding-right:24px;}}@media (min-width:0px){@media (orientation: landscape){.css-14ohe92{min-height:48px;}}}@media (min-width:600px){.css-14ohe92{min-height:64px;}}</style><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular globalNav_global-nav__container__50IoE css-14ohe92"><style data-emotion="css 1go1omd">.css-1go1omd{width:-webkit-min-content;width:-moz-min-content;width:min-content;}@media (min-width:0px){.css-1go1omd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}@media (min-width:900px){.css-1go1omd{display:none;}}</style><div class="MuiBox-root css-1go1omd"><div><style data-emotion="css 1wf493t">.css-1wf493t{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1wf493t:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1wf493t:hover{background-color:transparent;}}.css-1wf493t.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css 1yxmbwk">.css-1yxmbwk{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1yxmbwk::-moz-focus-inner{border-style:none;}.css-1yxmbwk.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1yxmbwk{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1yxmbwk:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1yxmbwk:hover{background-color:transparent;}}.css-1yxmbwk.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yxmbwk" tabindex="0" type="button" id="openmenu"><style data-emotion="css 1thg01k">.css-1thg01k{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;color:#f3f2f1;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1thg01k" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button><style data-emotion="css zrndxx">.css-zrndxx{z-index:1200;width:max(50%, 180px);-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.css-zrndxx .MuiDrawer-paper{width:max(50%, 180px);box-sizing:border-box;}</style></div></div><style data-emotion="css 1gup2uv">.css-1gup2uv{margin:0;font-size:1.5rem;font-weight:600;font-family:'Epilogue','Sora',sans-serif;line-height:1.167;color:#f3f2f1;}</style><style data-emotion="css 1m9wjdg">.css-1m9wjdg{-webkit-text-decoration:none;text-decoration:none;margin:0;font-size:1.5rem;font-weight:600;font-family:'Epilogue','Sora',sans-serif;line-height:1.167;color:#f3f2f1;}</style><style data-emotion="css 1h4ptik">.css-1h4ptik{margin:0;color:#9EBCEA;-webkit-text-decoration:none;text-decoration:none;margin:0;font-size:1.5rem;font-weight:600;font-family:'Epilogue','Sora',sans-serif;line-height:1.167;color:#f3f2f1;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone MuiTypography-root MuiTypography-h3 undefined globalNav_global-nav__link__FnV8h css-1h4ptik" href="/">stephen kernan</a><style data-emotion="css 1guk29">@media (min-width:0px){.css-1guk29{display:none;}}@media (min-width:900px){.css-1guk29{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><div class="globalNav_global-nav__middle-section___qUau MuiBox-root css-1guk29"><style data-emotion="css 1s88t3a">.css-1s88t3a{margin:0;font-family:'Sora','Epilogue',sans-serif;font-size:1.25rem;font-weight:400;line-height:1.43;color:#f3f2f1;border-bottom:4px solid transparent;}@media (min-width:0px){.css-1s88t3a{display:none;}}@media (min-width:900px){.css-1s88t3a{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><style data-emotion="css 18bud4w">.css-18bud4w{-webkit-text-decoration:none;text-decoration:none;margin:0;font-family:'Sora','Epilogue',sans-serif;font-size:1.25rem;font-weight:400;line-height:1.43;color:#f3f2f1;border-bottom:4px solid transparent;}@media (min-width:0px){.css-18bud4w{display:none;}}@media (min-width:900px){.css-18bud4w{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><style data-emotion="css b6ip91">.css-b6ip91{margin:0;color:#9EBCEA;-webkit-text-decoration:none;text-decoration:none;margin:0;font-family:'Sora','Epilogue',sans-serif;font-size:1.25rem;font-weight:400;line-height:1.43;color:#f3f2f1;border-bottom:4px solid transparent;}@media (min-width:0px){.css-b6ip91{display:none;}}@media (min-width:900px){.css-b6ip91{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone MuiTypography-root MuiTypography-body2 global-nav__link css-b6ip91" href="/about">about</a><style data-emotion="css ib6gfi">.css-ib6gfi{margin:0;font-family:'Sora','Epilogue',sans-serif;font-size:1.25rem;font-weight:400;line-height:1.43;color:#f3f2f1;border-bottom:4px solid #9EBCEA;}@media (min-width:0px){.css-ib6gfi{display:none;}}@media (min-width:900px){.css-ib6gfi{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><style data-emotion="css 9abjg1">.css-9abjg1{-webkit-text-decoration:none;text-decoration:none;margin:0;font-family:'Sora','Epilogue',sans-serif;font-size:1.25rem;font-weight:400;line-height:1.43;color:#f3f2f1;border-bottom:4px solid #9EBCEA;}@media (min-width:0px){.css-9abjg1{display:none;}}@media (min-width:900px){.css-9abjg1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><style data-emotion="css uzmhpa">.css-uzmhpa{margin:0;color:#9EBCEA;-webkit-text-decoration:none;text-decoration:none;margin:0;font-family:'Sora','Epilogue',sans-serif;font-size:1.25rem;font-weight:400;line-height:1.43;color:#f3f2f1;border-bottom:4px solid #9EBCEA;}@media (min-width:0px){.css-uzmhpa{display:none;}}@media (min-width:900px){.css-uzmhpa{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone MuiTypography-root MuiTypography-body2 global-nav__link css-uzmhpa" href="/blog">blog</a></div></div></header><style data-emotion="css 1qsxih2">.css-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1qsxih2{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg content-container css-1qsxih2"><style data-emotion="css 86a5qd">.css-86a5qd{margin:0;font-size:clamp(2rem, 10vw, 6rem);line-height:clamp(2.5rem, 12vw, 7rem);font-weight:900;color:#9EBCEA;}</style><h1 class="MuiTypography-root MuiTypography-semiHuge css-86a5qd">The Prop Constructor Pattern</h1><style data-emotion="css x5xb4d">.css-x5xb4d{margin:0;font-size:clamp(1rem, 5vw, 2.5rem);line-height:clamp(2rem, 7.5vw, 3.5rem);font-weight:700;margin-top:0!important;}</style><h2 class="MuiTypography-root MuiTypography-subHeader css-x5xb4d">A simple way to write cleaner, more flexible React tests.</h2><style data-emotion="css 1mdcnbq">.css-1mdcnbq{margin:0;font-family:'Epilogue','Sora',sans-serif;font-size:clamp(1rem, 4vw, 1.25rem);line-height:1.75em;font-weight:400;}</style><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Imagine that you&#x27;ve built a simple <code>Button</code> component, like this:</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    export const Button = ({ label, onClick, variant }) =&gt; {
      return (
        &lt;button
          data-testid=&quot;button&quot;
          className={`button-${variant}`}
          onClick={onClick}
        &gt;
          {label}
        &lt;/button&gt;
      );
    };
  </code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">This <code>Button</code> component is pretty simple. It should render a button on the page which contains the text provided by the<!-- --> <code>label</code> prop, it appends the provided <code>variant</code> <!-- -->prop to the<code>className</code>, and it executes the <code>onClick</code> <!-- -->function when clicked. To make sure that your component works as intended, you go through and add a few simple unit tests.</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    const onClickMock = jest.fn();

    describe(&quot;Button&quot;, () =&gt; {
      describe(&quot;label&quot;, () =&gt; {
        it(&quot;Renders with the correct label&quot;, () =&gt; {
          render(&lt;Button label=&quot;Test&quot; onClick={onClickMock} variant=&quot;primary&quot; /&gt;);

          expect(screen.getByTestId(&quot;button&quot;)).toBeVisible();
        });
      });
      describe(&quot;variant&quot;, () =&gt; {
        it(&quot;Applies the button-{variant} class to the &quot;, () =&gt; {
          render(&lt;Button label=&quot;Test&quot; onClick={onClickMock} variant=&quot;primary&quot; /&gt;);

          expect(screen.getByTestId(&quot;button&quot;)).toBeVisible();
        });
      });
      describe(&quot;onClick()&quot;, () =&gt; {
        it(&quot;Calls onClick when clicked&quot;, () =&gt; {
          render(&lt;Button label=&quot;Test&quot; onClick={onClickMock} variant=&quot;primary&quot; /&gt;);
          fireEvent.click(screen.getByTestId(&quot;button&quot;));

          expect(onClickMock).toHaveBeenCalledTimes(1);
        });
      });
    });
</code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">There&#x27;s nothing <em>wrong</em> with these tests. In fact, I would say that the average test suite for a React component may even look like this.</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">But, if you&#x27;re like me, then there may be a little DRY alarm going off in your head 🚨</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Each of these tests manually renders the component, with each prop explicitly defined in every test. This is a problem for a few reasons:</p><ol><li><bold>It&#x27;s dangerous to add new props</bold> - Any prop that gets added to the component must be explicitly added to<!-- --> <em>every test</em>. That may not be a huge deal for this component, since there are only three tests, but some components can have as many as 50-100 unit tests.</li><li><bold>It&#x27;s a lot of typing</bold> - This seems like a minor detail, but extra friction in the test-writing process can make it feel like a chore and will encourage poor tests (or worse, <em>no tests</em>! 👻)</li></ol><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Imagine that your fantastic product manager reaches out and requests that a <code>disabled</code> field should be added to the<!-- --> <code>Button</code> so that no customer can press the button without being logged in. One quick change to the component and, voila 🪄, our button can be disabled:</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    export const Button = ({ label, onClick, variant, disabled }) =&gt; {
      return (
        &lt;button
          data-testid=&quot;button-with-disable&quot;
          className={`button-${variant}`}
          onClick={onClick}
          disabled={disabled}
        &gt;
          {label}
        &lt;/button&gt;
      );
    };
</code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Now let&#x27;s add some tests. If we follow the pattern of the tests above, we might do something like this:</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    const onClickMock = jest.fn();

    describe(&quot;Button&quot;, () =&gt; {
      //...other tests (each of which need a disabled field too)...
      
      describe(&quot;onClick()&quot;, () =&gt; {
      // existing test, which still has to be updated
        it(&quot;if button is not disabled, calls onClick when clicked&quot;, () =&gt; {
          render(
            &lt;Button 
              label=&quot;Test&quot;
              onClick={onClickMock}
              variant=&quot;primary&quot;
              disabled={true}
            /&gt;
          );
          fireEvent.click(screen.getByTestId(&quot;button&quot;));

          expect(onClickMock).toHaveBeenCalledTimes(1);
        });

      // new test, which is yet another explicit component render
        it(&quot;if button is disabled, *does not* call onClick when clicked&quot;, () =&gt; {
          render(
            &lt;Button 
              label=&quot;Test&quot;
              onClick={onClickMock}
              variant=&quot;primary&quot;
              disabled={true}
            /&gt;
          );
          fireEvent.click(screen.getByTestId(&quot;button&quot;));

          expect(onClickMock).toHaveBeenCalledTimes(0);
        });
      });
    });
</code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Not only is there some extra typing involved, but every previous test must be updated to include a <code>disabled</code> field as well. To make matters worse, the test we just added will only add to the number of updates required for future props.</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Let&#x27;s see if we can make these tests a bit more reusable!</p><style data-emotion="css 1yrdh58">.css-1yrdh58{margin:0;font-size:2rem;font-weight:900;font-family:'Epilogue','Sora',sans-serif;line-height:1.2;}</style><h2 class="MuiTypography-root MuiTypography-h2 css-1yrdh58">A Common Solution: A Render Function</h2><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Let&#x27;s take a look at the most common solution I have seen to avoid duplication in test files - a <code>render</code> function. Here&#x27;s how the render function would improve our original test cases:</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    const onClickMock = jest.fn();

    const renderButton = () =&gt; {
      render(&lt;Button label=&quot;Test&quot; onClick={onClickMock} variant=&quot;primary&quot; /&gt;);
    }

    describe(&quot;Button&quot;, () =&gt; {
      describe(&quot;label&quot;, () =&gt; {
        it(&quot;Renders with the correct label&quot;, () =&gt; {
          renderButton();

          expect(screen.getByTestId(&quot;button&quot;)).toBeVisible();
        });
      });
      describe(&quot;variant&quot;, () =&gt; {
        it(&quot;Applies the button-{variant} class to the &quot;, () =&gt; {
          renderButton();

          expect(screen.getByTestId(&quot;button&quot;).classList).toInclude(&quot;primary&quot;);
        });
      });
      describe(&quot;onClick()&quot;, () =&gt; {
        it(&quot;Calls onClick when clicked&quot;, () =&gt; {
          renderButton()
          fireEvent.click(screen.getByTestId(&quot;button&quot;));

          expect(onClickMock).toHaveBeenCalledTimes(1);
        });
      });
    });
</code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Rather than explicitly defining our component and it&#x27;s props over and over, we&#x27;ve created a new function, <code>renderButton</code>, which handles all of that logic for us. The DRY alarm has relented and my brain is quiet once more. Peace at last 🧘</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">But there&#x27;s a catch. What happens if your tests needs different props?</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">When adding tests for the <code>disabled</code> case, we want to test both when the button is disabled and when it <em>isn&#x27;t</em>. However, our<code>renderButton</code> function doesn&#x27;t accomodate that very well:</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    const renderButton = () =&gt; {
      render(&lt;Button label=&quot;Test&quot; onClick={onClickMock} variant=&quot;primary&quot; disabled={false} /&gt;);
    }

    describe(&quot;Button&quot;, () =&gt; {
      afterEach(() =&gt; {
        jest.resetAllMocks();
      });
      
      // ...other tests

      describe(&quot;onClick()&quot;, () =&gt; {
      // this test can use the render function
        it(&quot;If !disabled, calls onClick when clicked&quot;, () =&gt; {
          renderButton();
          fireEvent.click(screen.getByTestId(&quot;button&quot;));

          expect(onClickMock).toHaveBeenCalledTimes(1);
        });

        // this test *must* render manually to enforce the disabled prop
        it(&quot;If disabled, *does not call* onClick when clicked&quot;, () =&gt; {
          render(
            &lt;Button
              label=&quot;Test&quot;
              onClick={onClickMock}
              variant=&quot;primary&quot;
              disabled={true}
            /&gt;
          );
          fireEvent.click(screen.getByTestId(&quot;button&quot;));

          expect(onClickMock).toHaveBeenCalledTimes(0);
        });
      });
    });
</code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Notice that we have to make a <em>choice</em> with the props in our<code>renderButton</code> function. In other words, we&#x27;re locked in 🔒</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">This is the biggest weakness with the reusable render function. The lack of flexibility means that any tests which require a variation from the standard props <em>still</em> have to explicitly render the component and list its props. To make matters worse, we now have a mix of explicit and standard renderings to parse through any time we add props so we&#x27;ve even lost some of the benefits of being DRY in the first place.</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">So what can we do?</p><div class="callout info">💡 <!-- --> <span class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">It&#x27;s possible to alleviate this (to some extent) by having separate render functions. In our case, we would have a<code>renderButton</code> and a <code>renderButtonDisabled</code>. However, I&#x27;ve found that this approach is very difficult to scale as the number of props increase or the logic inside of the component grows. Imagine having a<!-- --> <code>renderSecondaryButtonDisabled</code>. That would become a nightmare 😱</span></div><h2 class="MuiTypography-root MuiTypography-h2 css-1yrdh58">A More Flexible Approach: The Prop Constructor Pattern</h2><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">We can use the Prop Constructor Pattern! This pattern takes advantage of the Javascript <em>spread operator</em> (<code>{...obj}</code>) to build a render function which removes unnecessary repetition while also giving us the flexibility we need to customize any of our props on the fly.</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Here&#x27;s our new-and-improved <code>renderButton</code> function 🎉:</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    // establish a shared starting point with defaultProps
    const defaultProps = {
      label: &quot;Test&quot;,
      onClick: onClickMock,
      variant: &quot;primary&quot;,
      disabled: false,
    };

    // allow a custom props object as a parameter to your render function.
    const renderButton = (customProps = {}) =&gt; {
      // the spread operator allows us to overwrite any variables we 
      // explicitly provide, while *keeping the default value* of any
      // other props
      const componentProps = { ...defaultProps, ...customProps };

      // then, we unpack the combined props into our component
      render(&lt;Button {...componentProps} /&gt;);
    };
  </code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">So let&#x27;s walk through the changes.</p><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Notice that now we&#x27;re taking in a <code>customProps</code> object. I&#x27;ve defaulted it to an empty object so that, even <em>without</em>customProps, our render function will be able to pass in the default props correctly. We can then use the spread operator to <em>merge</em>our <code>defaultProps</code> object with the <code>customProps</code> <!-- -->object. This means that any props we explicitly define in our<!-- --> <code>customProps</code> object <em>overwrite</em> those props in the<!-- --> <code>defaultProps</code> object while leaving the other values intact. Here&#x27;s a small example:</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    const obj1 = { first: 100, second: 20, last: 5}
    const obj2 = { third: 15, last: 2 }

    console.log({ ...obj1, ...obj2 })
    // { first: 100, second: 20, third: 15, last: 2}
</code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Now let&#x27;s write some tests 👍</p><pre><code data-prismjs-copy="📋 Copy to Clipboard" data-prismjs-copy-success="✅ Copied!">
    describe(&quot;Button&quot;, () =&gt; {
      afterEach(() =&gt; {
        jest.resetAllMocks();
      });

      // ...other tests

      describe(&quot;onClick()&quot;, () =&gt; {
        it(&quot;If disabled is false, calls onClick when clicked&quot;, () =&gt; {
          renderButton();
          fireEvent.click(screen.getByTestId(&quot;button-with-disable&quot;));

          expect(onClickMock).toHaveBeenCalledTimes(1);
        });

      // now this test can use the same function!
        it(&quot;If disabled is true, *does not call* onClick when clicked&quot;, () =&gt; {
          renderButton({ disabled: true });
          fireEvent.click(screen.getByTestId(&quot;button-with-disable&quot;));

          expect(onClickMock).toHaveBeenCalledTimes(0);
        });
      });
    });
</code></pre><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">Look at that improvement with only a few extra lines of code in the<!-- --> <code>renderButton</code> function! Not only can the original test still use the <code>renderButton</code> function with its default props, but our new test can add its own props too 🙌</p><h2 class="MuiTypography-root MuiTypography-h2 css-1yrdh58">The Benefits of the Prop Constructor Pattern</h2><p class="MuiTypography-root MuiTypography-body1 css-1mdcnbq">To recap, here are some of the benefits of using the Prop Constructor Pattern:</p><ol><li>It avoids unnecessary duplication</li><li>It provides flexibility to adjust props when needed</li><li>Bonus: It&#x27;s immediately clear which props are being manipulated in the test</li></ol></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blog/prop-constructor-pattern","query":{},"buildId":"4BpwgWXTCw54Ent2NKMWK","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>